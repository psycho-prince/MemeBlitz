<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="referrer" content="no-referrer">
    <title>MemeBlitz 2025 - Global Edition</title>
    <script src="https://unpkg.com/peerjs@1.5.2/dist/peerjs.min.js"></script>
    <style>
        :root { --primary: #00ff88; --bg: #0f172a; --card: #1e293b; --text: #f8fafc; }
        body { font-family: 'Inter', sans-serif; background: var(--bg); color: var(--text); text-align: center; margin: 0; padding: 10px; }
        .container { max-width: 700px; margin: 20px auto; background: var(--card); padding: 25px; border-radius: 20px; box-shadow: 0 20px 50px rgba(0,0,0,0.5); }
        .meme-box { position: relative; min-height: 300px; display: flex; align-items: center; justify-content: center; background: #000; border-radius: 15px; overflow: hidden; margin-bottom: 20px; border: 3px solid #334155; }
        img { max-width: 100%; max-height: 500px; display: none; transition: transform 0.3s; }
        input { padding: 15px; border-radius: 10px; border: 2px solid #334155; width: 80%; font-size: 18px; background: #0f172a; color: white; margin: 10px 0; outline: none; }
        input:focus { border-color: var(--primary); }
        button { padding: 15px 30px; border-radius: 10px; border: none; background: var(--primary); color: #000; cursor: pointer; font-weight: 800; font-size: 16px; text-transform: uppercase; letter-spacing: 1px; }
        .hidden { display: none; }
        #scoreList { display: grid; grid-template-columns: repeat(2, 1fr); gap: 10px; margin-top: 15px; text-align: left; font-size: 14px; }
        .badge { background: #334155; padding: 5px 10px; border-radius: 5px; margin-bottom: 5px; border-left: 4px solid var(--primary); }
    </style>
</head>
<body>

<div class="container">
    <h1 style="color: var(--primary);">üñºÔ∏è MEME BLITZ 2025</h1>
    
    <div id="lobby">
        <input type="text" id="username" placeholder="Your Gamer Name">
        <div style="margin-top: 10px;">
            <button onclick="createRoom()">Create Room</button>
            <p>‚Äî OR ‚Äî</p>
            <input type="text" id="joinId" placeholder="Paste Room ID Here">
            <button onclick="joinRoom()" style="background: #38bdf8;">Join Room</button>
        </div>
        <p id="status" style="color: #94a3b8;"></p>
    </div>

    <div id="game" class="hidden">
        <div id="roomDisplay" style="font-size: 12px; color: var(--primary); margin-bottom: 10px;"></div>
        <div class="meme-box">
            <div id="loader" style="color: white;">Loading Meme...</div>
            <img id="memeImage" src="" onload="document.getElementById('loader').style.display='none'; this.style.display='block'">
        </div>
        
        <input type="text" id="guessInput" placeholder="WHAT IS THIS?" onkeyup="checkEnter(event)">
        
        <div id="hostControls" class="hidden">
            <button onclick="nextMeme()" style="width: 100%; margin-top: 10px; background: #fbbf24;">NEXT MEME ‚è≠Ô∏è</button>
        </div>

        <div id="scoreList"></div>
    </div>
</div>

<script>
// --- YOUR 2025 VIRAL MEME DATA ---
const memes = [
    { url: "https://d12jofbmgge65s.cloudfront.net/wp-content/uploads/2025/08/2025-trends-so-far-blog.webp", answers: ["dubai chocolate", "pistachio chocolate", "fix chocolate"] },
    { url: "https://media.cybernews.com/images/featured-big/2025/03/italian-brainrot.jpg", answers: ["italian brainrot", "brainrot", "ai animals"] },
    { url: "https://images.financialexpressdigital.com/2025/07/Coldplay-Kiss-Cam-Scandal-memes.jpg", answers: ["coldplay kiss cam", "coldplay scandal", "kiss cam"] },
    { url: "https://i.ytimg.com/vi/nOcloBtPPdc/maxres2.jpg", answers: ["druski", "druski dance", "druski funny"] },
    { url: "https://images.euronews.com/articles/stories/09/46/02/81/1536x864_cmsv2_519ef347-4935-589b-9357-36058bb5c9ff-9460281.jpg", answers: ["tralalero tralala", "italian brainrot", "ai creature"] },
    { url: "https://img-s-msn-com.akamaized.net/tenant/amp/entityid/AA1I8Vrc.img?w=768&h=432&m=6", answers: ["labubu", "labubu dubai chocolate", "matcha labubu"] },
    { url: "https://www.hindustantimes.com/ht-img/img/2025/10/30/550x309/jk_1761841605679_1761841611832.png", answers: ["coldplay affair", "kiss cam scandal", "kristin cabot"] },
    { url: "https://i0.wp.com/accountabilitynow.net/wp-content/uploads/2025/11/9-hilarious-funny-ai-ideas-for-sales-vps-to-try-in-2025.jpg", answers: ["ai memes", "sales memes", "2025 ai"] }
];

let peer, conn, myName, roomId, isHost = false, currentMemeIndex = -1, scores = {};

function createRoom() {
    myName = document.getElementById('username').value || "Player1";
    peer = new Peer();
    peer.on('open', (id) => {
        roomId = id; isHost = true;
        showGame(`ROOM ID: ${id}`);
        document.getElementById('hostControls').classList.remove('hidden');
        setupHostListeners();
    });
}

function joinRoom() {
    const targetId = document.getElementById('joinId').value;
    myName = document.getElementById('username').value || "Guest";
    peer = new Peer();
    peer.on('open', () => {
        conn = peer.connect(targetId);
        conn.on('open', () => {
            conn.send({ type: 'join', name: myName });
            showGame("CONNECTED!");
            setupClientListeners();
        });
    });
}

function setupHostListeners() {
    peer.on('connection', (c) => {
        c.on('data', (data) => {
            if (data.type === 'join') { 
                scores[data.name] = 0; 
                updateScoreboard(); 
                broadcast({ type: 'updateScores', scores });
                if(currentMemeIndex !== -1) c.send({ type: 'newMeme', index: currentMemeIndex });
            }
            if (data.type === 'guess') handleGuess(data.name, data.text);
        });
    });
}

function setupClientListeners() {
    conn.on('data', (data) => {
        if (data.type === 'newMeme') updateMeme(data.index);
        if (data.type === 'updateScores') { scores = data.scores; updateScoreboard(); }
    });
}

function nextMeme() {
    currentMemeIndex++;
    if(currentMemeIndex >= memes.length) currentMemeIndex = 0;
    updateMeme(currentMemeIndex);
    broadcast({ type: 'newMeme', index: currentMemeIndex });
}

function updateMeme(index) {
    currentMemeIndex = index;
    const img = document.getElementById('memeImage');
    img.style.display = "none";
    document.getElementById('loader').style.display = "block";
    img.src = memes[index].url;
    document.getElementById('guessInput').value = "";
    document.getElementById('guessInput').focus();
}

function handleGuess(player, text) {
    const cleanGuess = text.toLowerCase().trim();
    if (memes[currentMemeIndex].answers.some(a => cleanGuess.includes(a))) {
        scores[player] = (scores[player] || 0) + 10;
        updateScoreboard();
        broadcast({ type: 'updateScores', scores });
        nextMeme();
    }
}

function submitGuess() {
    const val = document.getElementById('guessInput').value;
    if (isHost) handleGuess(myName, val);
    else conn.send({ type: 'guess', name: myName, text: val });
}

function showGame(msg) {
    document.getElementById('lobby').classList.add('hidden');
    document.getElementById('game').classList.remove('hidden');
    document.getElementById('roomDisplay').innerText = msg;
    scores[myName] = 0; updateScoreboard();
}

function updateScoreboard() {
    const list = document.getElementById('scoreList');
    list.innerHTML = Object.entries(scores)
        .sort((a,b) => b[1] - a[1])
        .map(([n, s]) => `<div class="badge"><b>${n}</b>: ${s} pts</div>`).join('');
}

function broadcast(data) {
    Object.values(peer.connections).forEach(conns => conns.forEach(c => c.send(data)));
}

function checkEnter(e) { if (e.key === "Enter") submitGuess(); }
</script>
</body>
</html>

